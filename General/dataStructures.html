<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="A collection of notes describing a few aspects of R for bioinformatics.">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="stylesheet" href="../stylesheets/stylesheet.css" media="screen"/>
  <link rel="stylesheet" href="../stylesheets/pygment_trac.css"/>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="../javascripts/script.js"></script>
  <title>R data structures</title>
</head>

<body>

  <div class="wrapper">
    <header>
      <h1 class="title">R Notes for Bioinformatics</h1>
    </header>
    <div id="container">
      <p class="tagline">A collection of notes describing a few aspects of R for bioinformatics.</p>
      <div id="main" role="main">
        <div class="download-bar">
        <div class="inner">
          <a href="https://github.com/chernan/RNotes4Bioinformatics/tarball/gh-pages" class="download-button tar"><span>Download</span></a>
          <a href="https://github.com/chernan/RNotes4Bioinformatics/zipball/gh-pages" class="download-button zip"><span>Download</span></a>
          <a href="https://github.com/chernan/RNotes4Bioinformatics" class="code">View R Notes for Bioinformatics on GitHub</a>
        </div>
        <span class="blc"></span><span class="trc"></span>
        </div>
        <article class="markdown-body">
        
<h1>R data structures</h1>

<p>Any R object has 2 attributes: mode (type of data: logical, numeric, function, complex, character, raw, list,&hellip;) and class (label)</p>

<h2>R storage modes</h2>

<p>Obtained by the typeof() function</p>

<pre><code class="r">f &lt;- function() {
}
f$a
</code></pre>

<pre><code>## Error: objet de type &#39;closure&#39; non indiçable
</code></pre>

<pre><code class="r">## Error mentionning type &#39;closure&#39;
</code></pre>

<p>logical, numeric (integer or double), function (closure or builtin or special)</p>

<h2>Logical</h2>

<p>Easy to convert (and back) with numeric. But this easy conversion can cause problems.</p>

<pre><code class="r">vector &lt;- 1:10
vector[c(0, 1)]
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">vector[c(F, T)]
</code></pre>

<pre><code>## [1]  2  4  6  8 10
</code></pre>

<p>Never use F and T shortcuts for False and TRUE.</p>

<h2>Vector</h2>

<p>Contain values of the <strong>same mode</strong>.</p>

<pre><code class="r">x &lt;- c(1, 2, 3, 4)
x
</code></pre>

<pre><code>## [1] 1 2 3 4
</code></pre>

<pre><code class="r">mode(x)
</code></pre>

<pre><code>## [1] &quot;numeric&quot;
</code></pre>

<pre><code class="r">x &lt;- c(1, 2, TRUE, 3)
x
</code></pre>

<pre><code>## [1] 1 2 1 3
</code></pre>

<pre><code class="r">mode(x)
</code></pre>

<pre><code>## [1] &quot;numeric&quot;
</code></pre>

<pre><code class="r">x &lt;- c(1, 2, &quot;true&quot;, 4)
x
</code></pre>

<pre><code>## [1] &quot;1&quot;    &quot;2&quot;    &quot;true&quot; &quot;4&quot;
</code></pre>

<pre><code class="r">mode(x)
</code></pre>

<pre><code>## [1] &quot;character&quot;
</code></pre>

<h2>Matrix</h2>

<p>Can also access an element with one index</p>

<pre><code class="r">a &lt;- 1:30
attr(a, &quot;dim&quot;) &lt;- c(5, 6)
class(a) &lt;- &quot;matrix&quot;
a
</code></pre>

<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    6   11   16   21   26
## [2,]    2    7   12   17   22   27
## [3,]    3    8   13   18   23   28
## [4,]    4    9   14   19   24   29
## [5,]    5   10   15   20   25   30
</code></pre>

<pre><code class="r">a[11]
</code></pre>

<pre><code>## [1] 11
</code></pre>

<pre><code class="r">a[1, 3]
</code></pre>

<pre><code>## [1] 11
</code></pre>

<p>As for vectors, all elements must be of the same mode. Insert a text, and all numeric will turn into characters.</p>

<h2>List</h2>

<p>Is a collection of objects with different modes. Access either by rank or by name.</p>

<pre><code class="r">mylist &lt;- list(ages = c(12, 35, 34, 62), height = c(135, 128, 164, 165), sex = c(&quot;M&quot;, 
    &quot;F&quot;, &quot;M&quot;, &quot;M&quot;))
mylist[[1]]
</code></pre>

<pre><code>## [1] 12 35 34 62
</code></pre>

<pre><code class="r">class(mylist[[1]])
</code></pre>

<pre><code>## [1] &quot;numeric&quot;
</code></pre>

<pre><code class="r">mylist[1]
</code></pre>

<pre><code>## $ages
## [1] 12 35 34 62
</code></pre>

<pre><code class="r">class(mylist[1])
</code></pre>

<pre><code>## [1] &quot;list&quot;
</code></pre>

<pre><code class="r">mylist$height
</code></pre>

<pre><code>## [1] 135 128 164 165
</code></pre>

<h2>Data frames</h2>

<p>List with each element has same number of elements.</p>

<pre><code class="r">data &lt;- as.data.frame(mylist)
data
</code></pre>

<pre><code>##   ages height sex
## 1   12    135   M
## 2   35    128   F
## 3   34    164   M
## 4   62    165   M
</code></pre>

<pre><code class="r">class(data)
</code></pre>

<pre><code>## [1] &quot;data.frame&quot;
</code></pre>

<pre><code class="r">mode(data)
</code></pre>

<pre><code>## [1] &quot;list&quot;
</code></pre>

<h3>Data access</h3>

<pre><code class="r">data[1]
</code></pre>

<pre><code>##   ages
## 1   12
## 2   35
## 3   34
## 4   62
</code></pre>

<pre><code class="r">data[[1]]
</code></pre>

<pre><code>## [1] 12 35 34 62
</code></pre>

<pre><code class="r">data$height
</code></pre>

<pre><code>## [1] 135 128 164 165
</code></pre>

<p>A good rule of thumb is to always <strong>use labels</strong> for accessing data frame columns (in case order changes), and <strong>full labels</strong> as partial labels imply R checking for all column names.</p>

<h3>Subset</h3>

<p>Using negative indices (not valid with column names).</p>

<pre><code class="r">data[, -2]
</code></pre>

<pre><code>##   ages sex
## 1   12   M
## 2   35   F
## 3   34   M
## 4   62   M
</code></pre>

<p>Using -grep() but be carefull of which column really matches.</p>

<pre><code class="r">data[, -grep(&quot;h&quot;, names(data))]
</code></pre>

<pre><code>##   ages sex
## 1   12   M
## 2   35   F
## 3   34   M
## 4   62   M
</code></pre>

<p>Using subset() and a - sign in front of the column name you want to discard.</p>

<pre><code class="r">subset(data, select = -height)
</code></pre>

<pre><code>##   ages sex
## 1   12   M
## 2   35   F
## 3   34   M
## 4   62   M
</code></pre>

<h2>Factors</h2>

<p>Represent categorical variables.</p>

<pre><code class="r">hair &lt;- factor(c(&quot;blond&quot;, &quot;brown&quot;, &quot;red&quot;, &quot;blond&quot;))
hair
</code></pre>

<pre><code>## [1] blond brown red   blond
## Levels: blond brown red
</code></pre>

<pre><code class="r">hair[2] &lt;- &quot;blond&quot;
hair[2] &lt;- &quot;grey&quot;
</code></pre>

<pre><code>## Warning: niveau de facteur incorrect, NAs générés
</code></pre>

<pre><code class="r">hair
</code></pre>

<pre><code>## [1] blond &lt;NA&gt;  red   blond
## Levels: blond brown red
</code></pre>

<pre><code class="r">class(hair)
</code></pre>

<pre><code>## [1] &quot;factor&quot;
</code></pre>

<pre><code class="r">mode(hair)
</code></pre>

<pre><code>## [1] &quot;numeric&quot;
</code></pre>

<pre><code class="r">as.numeric(hair)
</code></pre>

<pre><code>## [1]  1 NA  3  1
</code></pre>

<p>They are also more memory-efficient than tables of characters.</p>

<p>Difficult to concatenate</p>

<pre><code class="r">c(hair, hair)
</code></pre>

<pre><code>## [1]  1 NA  3  1  1 NA  3  1
</code></pre>

<pre><code class="r"># Workaround 1
factor(as.character(hair), as.character(hair))
</code></pre>

<pre><code>## Warning: les niveaux dupliqués ne seront plus acceptés pour les variables
## de type &#39;factor&#39;
</code></pre>

<pre><code>## [1] blond &lt;NA&gt;  red   blond
## Levels: blond red blond
</code></pre>

<pre><code class="r"># Workaround 2
unlist(list(hair, hair))
</code></pre>

<pre><code>## [1] blond &lt;NA&gt;  red   blond blond &lt;NA&gt;  red   blond
## Levels: blond brown red
</code></pre>

<p>To add a value: turn factor to character, add element and turn it to factor again.</p>

<p>Use ordered=TRUE for ordered values.</p>

<pre><code class="r">time &lt;- factor(c(1, 2, 3, 2, 2, 1), levels = c(1, 2, 3), labels = c(&quot;never&quot;, 
    &quot;sometimes&quot;, &quot;always&quot;), ordered = TRUE)
time
</code></pre>

<pre><code>## [1] never     sometimes always    sometimes sometimes never    
## Levels: never &lt; sometimes &lt; always
</code></pre>

<pre><code class="r">time[2] &lt; time[3]
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">&quot;sometimes&quot; &lt; &quot;always&quot;
</code></pre>

<pre><code>## [1] FALSE
</code></pre>

<pre><code class="r">boxplot(measure ~ groups)
</code></pre>

<pre><code>## Error: objet &#39;measure&#39; introuvable
</code></pre>

<pre><code class="r">summary(aov(measure ~ groups))
</code></pre>

<pre><code>## Error: objet &#39;measure&#39; introuvable
</code></pre>

<pre><code class="r">groups &lt;- as.factor(groups)
</code></pre>

<pre><code>## Error: objet &#39;groups&#39; introuvable
</code></pre>

<pre><code class="r">groups
</code></pre>

<pre><code>## Error: objet &#39;groups&#39; introuvable
</code></pre>

<pre><code class="r">summary(aov(measure ~ groups))
</code></pre>

<pre><code>## Error: objet &#39;measure&#39; introuvable
</code></pre>

<p>By default, data.frame() and read.table() convert all non-numerical values into factors.
Use stringsAsFactors=FALSE or as.is=TRUE 
It can also be set in defaults options(stringsAsFactors=FALSE)</p>

<h2>Other related functions</h2>

<h3>summary()</h3>

<pre><code class="r">summary(mylist)
</code></pre>

<pre><code>##        Length Class  Mode     
## ages   4      -none- numeric  
## height 4      -none- numeric  
## sex    4      -none- character
</code></pre>

<p>Class:none means that the class is the same as the mode.</p>

<h3>str()</h3>

<p><strong>Detailed</strong> information (as detailed as possible) about the structure of a model.</p>

<pre><code class="r">str(mylist)
</code></pre>

<pre><code>## List of 3
##  $ ages  : num [1:4] 12 35 34 62
##  $ height: num [1:4] 135 128 164 165
##  $ sex   : chr [1:4] &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;M&quot;
</code></pre>

<p><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a><br />This work by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Celine Hernandez</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</p>

        </article>
      </div>
    </div>
    <footer>
      <div class="owner">
      <p><a href="https://github.com/chernan" class="avatar"><img src="https://0.gravatar.com/avatar/87ffdd8b5458b07e667a4e23a636b8dd?d=https%3A%2F%2Fidenticons.github.com%2F52da2d5c8b30ddc47bfbd75cd46d8a65.png&amp;s=30" width="48" height="48"/></a> <a href="https://github.com/chernan">chernan</a> maintains <a href="https://github.com/chernan/RNotes4Bioinformatics">R Notes for Bioinformatics</a></p>


      </div>
      <div class="creds">
        <small>This page generated using <a href="https://pages.github.com/">GitHub Pages</a><br/>theme by <a href="https://twitter.com/jonrohan/">Jon Rohan</a></small>
      </div>
    </footer>
  </div>
  <div class="current-section">
    <a href="#top">Scroll to top</a>
    <a href="https://github.com/chernan/RNotes4Bioinformatics/tarball/master" class="tar">tar</a><a href="https://github.com/chernan/RNotes4Bioinformatics/zipball/master" class="zip">zip</a><a href="" class="code">source code</a>
    <p class="name"></p>
  </div>

  
</body>


</html>
